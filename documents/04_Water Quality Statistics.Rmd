---
editor_options: 
  markdown: 
    wrap: 72
---

# Water Quality Statistics

We developed a series of linear mixed effects models to estimate
concentrations for constituents of concern (COCs) in Puget Sound urban
stormwater. Spatial covariates in the models included various landscape
predictors, rainfall, seasonal components, and in some models, percent
land use (commercial, industrial, residential).

## Data Sources

### Outfall Data

The primary source of measured stormwater data is the S8.D Municipal
Stormwater Permit Outfall Data (referred to as the S8 Data in this
document) provided by the Washington Department of Ecology (Hobbs et
al., 2015). Special Condition S8.D of the 2007-2012 Phase I Municipal
Stormwater Permit required permittees to collect and analyze data to
evaluate pollutant loads in stormwater discharged from different land
uses: high density (HD) residential, low density (LD) residential,
commercial, and industrial. Phase I Permittees[^1] collected water
quality and flow data, sediment data, and toxicity information from
stormwater discharges during storm events. Stormwater data collected
from a total of 16 outfalls by six Phase I Permittees was utilized in
this modeling study.

[^1]: Phase I Permittees include: cities of Tacoma and Seattle; King,
    Snohomish, Pierce and Clark counties; Ports of Tacoma and Seattle. 
    For this study, all data were used with the exception of those from
    Clark County (outside of the Puget Sound region) and Port of Seattle
    (too different from all other Puget Sound watersheds).

The stormwater outfall data are available from Ecology via an open-data
api at:
[https://data.wa.gov/Natural-Resources-Environment/Municipal-Stormwater-
Permit-Outfall-Data/d958-q2ci.](https://data.wa.gov/Natural-Resources-Environment/Municipal-Stormwater-%20Permit-Outfall-Data/d958-q2ci.%20)

COCs analyzed in this study are:

-   Copper -- Total

-   Total Suspended Solids (TSS)

-   Phosphorus -- Total

-   Zinc - Total

-   Total Kjeldahl Nitrogen (TKN)

We extracted data for these COCs, and performed minimal data cleaning.
We filtered out rejected data (values with a R or REJ flag), removed
replicates, and removed one data point for TKN that was an outlier (an
order of magnitude higher than the majority of the data). Figure 4.1
shows data before removal of the outlier.

![](images/COC%20all%20data%20with%20outliers%20Fig%204_1.bmp)

**Figure 4.1** All observations with outlier in place for Total Kjeldahl
nitrogen (TKN)

### Censored (Non-Detect) Data

Nearly all COCs had non-detect (left-censored) data present (Table 4.1).
Ecology flagged non-detect data and provided the reporting limit for
each non-detect value. Most COCs had a very small percentage of data
that were non-detect (2% or less); one COC, TKN, had a higher level of
non-detect data (just over 10%). For all COCs, non-detect values were
substituted with one-half of the reporting limit. Models using censored
methods were compared to linear models for TKN to verify that data
substitution on linear mixed effects models generated suitable results.

**Table 4.1** Percentage of data points that were left-censored
(non-detect) for each chemical of concern

| Chemical of Concern     | Censored Data Perc entage | Notes                                                                                                                                                                                        |
|---------------|---------------|-------------------------------------------|
| Total Copper            | 0%                        | 4 samples were field blanks misclassified as ND's. Censored data percentage was calculated following removal of these 4 field blanks.                                                        |
| Total Kjeldahl Nitrogen | 9.76%                     |                                                                                                                                                                                              |
| Total Pho sphorus       | 1.17%                     | 3 samples with high results were classified as ND's, but should have been flagged as "estimated". Censored data percentage was calculated following reclassification of these 3 data points. |
| Total Su spended Solids | 0.83%                     |                                                                                                                                                                                              |
| Total Zinc              | 0%                        | 4 samples were field blanks misclassified as ND's. Censored data percentage was calculated following removal of these 4 field blanks                                                         |

### Transformation of outfall data

Each COC was then evaluated for its underlying distribution, to
determine whether transformation would be beneficial prior to running a
linear mixed effects model on the results. Quantile-quantile plots (QQ
plots) using a normal distribution, gamma distribution, square-root
transformed distribution, and log-transformed distribution were visually
analyzed. For all COC's, log-transformation was deemed an appropriate
data transformation prior to model analysis (Fig. 4.2).

![](images/QQ%20plots%20all%20COCs%20fig%204_2.bmp)

**Figure 4.2** Quantile-quantile plots of COCs using a natural-log (ln)
scale. Red line shows the QQ-line.

## Spatial Data

For this study, we did not rely on the permittee's self-reported land
use type to run regression models predicting pollution loading from land
use. A visual scan of our land cover data layer versus self-reported
land use types revealed little agreement among permittee definitions of
the four land use types (high density residential, low density
residential, commercial, industrial). Therefore, we compiled a suite of
continuous datasets from which to run chemical loading models. We divide
these into land use and landscape data.

### Land Use

In order to employ a consistent analysis across different monitored
watersheds we extracted land use data from the Washington Department of
Commerce Land Use: Puget Sound Mapping Project
(<https://www.commerce.wa.gov/serving-communities/growth-management/puget-sound-mapping-project>).
Land use classes (also listed in Table 4.2) include:

-   Intensive urban (includes commercial areas, apartment buildings)

-   Urban residential (includes the majority of urban and suburban
    single-family dwellings)

-   Rural residential

-   Industrial

In addition, we combined some land use classes to generate additional
land use classes:

-   Total residential (urban residential + rural residential)

-   Intensive Urban + Industrial; the industrial land use category did
    not have many non-zero data points

### Landscape Data

For each watershed contained in the S8 dataset, potentially relevant
landscape data were extracted from the following sources (Table 4.2):

**Table 4.2**: Sources of landscape spatial predictor data used to
develop statistical models.

| **Layer**                             | **ID**            | **Source**                                                                                           |
|-----------------|-----------------|---------------------------------------|
| urban residential                     | urbRES            | Washington State Department of Commerce, Puget Sound Mapping Project                                 |
| rural residential                     | ruRES             |                                                                                                      |
| total residential (urban + rural)     | totRES            |                                                                                                      |
| intensive urban                       | intURB            |                                                                                                      |
| industrial                            | IND               |                                                                                                      |
| intensive urban + industrial          | intURB_IND        |                                                                                                      |
| impervious surfaces                   | impervious        |                                                                                                      |
| paved surfaces                        | paved             |                                                                                                      |
| rooftop density                       | roofs             |                                                                                                      |
| urban residential rooftops            | roof_urbRES       | rooftop density applied to Washington State Department of Commerce, Puget Sound Mapping Project data |
| total residential rooftops            | roof_totRES       |                                                                                                      |
| intensive urban rooftops              | roof_intURB       |                                                                                                      |
| intensive urban + industrial rooftops | roof\_ intURB_IND |                                                                                                      |
| grass & low vegetation                | grass             |                                                                                                      |
| tree cover                            | trees             |                                                                                                      |
| total vegetative cover                | greenery          |                                                                                                      |
| undeveloped areas                     | nodev             |                                                                                                      |
| traffic                               | traffic           |                                                                                                      |
| population                            | popn              |                                                                                                      |
| particulate matter 2.5um              | pm25_na           |                                                                                                      |
| particulate surface area              | partSA            |                                                                                                      |
| NO2                                   | no2               |                                                                                                      |
| carbon emissions, commercial          | CO2_com           | Vulcan Carbon Dioxide Emissions data set                                                             |
| carbon emissions, residential         | CO2_res           |                                                                                                      |
| carbon emissions, road                | CO2_road          |                                                                                                      |
| carbon emissions, nonroad             | CO2_nonroad       |                                                                                                      |
| carbon emissions, total               | CO2_tot           |                                                                                                      |
| slope                                 | slope             |                                                                                                      |
| age of development                    | devAge            | Calculated value based on year of development                                                        |

### Pre-processing of spatial data

In order to use the landscape data at an appropriate scale across the
study area, spatial predictors were stacked and then convolved with a
100-meter gaussian kernel. This resulted in "fuzzy" predictors that
could apply across dataset boundaries. These values were then extracted
for each monitored watershed.

Prior to use, spatial data were plotted and visually assessed for
outliers (Fig. 4.3). Square-root transformation was performed on spatial
data sets with outliers that were higher than the rest of the
predictor's values: popn, traffic, slope, CO2_res, CO2_com, CO2_road,
CO2_nonroad, CO2_tot. The devAge spatial predictor had a low data
outlier; devAge values were squared to address the low outlier. Figure
4.4 shows the spatial data following transformation.

Prior to use in models, spatial data sets were scaled and centered using
the mean and standard deviation from the 14 watersheds in this study.

![](images/untransformed%20predictors%20fig_4_3.bmp)

**Figure 4.3** Raw spatial data

![](images/transformed%20predictors%20fig_4_4.bmp)

**Figure 4.4** Spatial data following transformation

### Precipitation Data

Daily rainfall data were obtained from the DayMet website operated by
NASA (<https://daymet.ornl.gov/>). Daily data were obtained for years
2009 to 2013, and cumulative one day, three day, and seven day, 14-day,
21-day and 28-day antecedent precipitation were calculated for each
sampling date. For example, for a sampling date of March 22, cumulative
three-day precipitation would include precipitation occurring on March
20, 21 and 22. For each COC, *ln*-transformed chemical concentrations
were plotted against each precipitation measurement, and the plots were
visually assessed to select the most appropriate time scale for
precipitation. Cumulative 21-day precipitation was selected for copper
and phosphorus, while 1-day precipitation was selected for TSS.

## Model Construction and Selection

We considered both a frequentist statistical framework, as well as a
Bayesian framework for running the mixed effects models, and ended up
utilizing a combination of the two. The frequentist framework is
significantly faster to perform, and was used to identify the best set
of landscape predictors as fixed effects, as well as to identify the
best variance structure (see Steps 1-7, below).

Once the best fit model was selected, we moved to a Bayesian framework
to estimate credibility intervals around predicted values. Frequentist
statistical methods are not able to properly estimate variability around
random effects, so Bayesian methods were needed for this step.

Within a frequentist statistical framework, selection of the best model
for each COC was performed using the methodology of Zuur al. (2009), as
outlined in Steps 1-7 below. Statistical analyses and model fitting were
performed in R (R Core Team, 2021).

### Step 1. Select strong potential landscape predictors

The initial step was to find a suitable set of potential landscape
predictors for the COC in question. Single-predictor linear models were
constructed for the relationship between *ln*-transformed chemical
concentration and each landscape predictor, in turn. Plots were visually
assessed to determine candidate predictors for linear mixed effects
models. We looked for slopes with a p-value of \< 0.05, and for data
points to fall roughly along the best fit model line.

### Step 2. Construct a beyond-optimal model, controlling for collinearity

The starting point of our model selection process was a "beyond-optimal"
model, where the fixed component of the mixed effects model contained as
many strong landscape predictors as possible, as well as weather-based
temporal components with potential importance (cumulative precipitation,
season, antecedant dry days):

$$Result_{ijk} = fixed.effects_{ijk} + \epsilon_{ijk}
$$

Subscripts indicate sample (*i*), location (*j*) and agency (*k*), and
$$\epsilon_{ijk} $$ indicates unexplained error for each sample. To
prevent using highly correlated landscape predictors together in
statistical models, we calculated calculated the correlation coefficient
for each coefficient pair of landscape predictors, and eliminated select
predictors to reduce correlation. We then constructed a generalized
least squared (gls) model in R (nlme package, Pinheiro et al., 2021)
using the beyond-optimal set of fixed effects, and utilizing restricted
maximum likelihood estimation (REML).

Throughout the model selection process, highly correlated landscape
predictors (correlation coefficient ≥0.85) were not used together in any
models.

### Step 3. Control for heterogeneity (heteroskedasticity)

Normalized residuals from the "beyond-optimal" gls model were plotted
against the model's fitted values, and examined for heteroskedasticity.
We also plotted residuals against agency, year, season, land use,
cumulative precipitation, antecedent dry days, and all potential
predictors, to look for patterns in residuals. If residual plots showed
evidence of heteroskedasticity, we tried a series of gls models (fitted
with REML) with different variance structures that utilized agency,
location, season, and precipitation as variance covariates. Variance
structure for each COC was selected based on the lowest Akaike
information criterion (AIC) and Bayesian information criterion (BIC)
scores.

If no heteroskedasticity is present, residuals are assumed to be
normally distributed, with mean 0 and standard deviation $$\sigma$$:

$$
\epsilon_{ijk} \sim N(0, \sigma) 
$$

Controlling for heteroskedasticity often involved allowing each location
*j* or each agency *k* to have a different standard deviation, such
that:

$$
sd(\epsilon_{ijk})=\sigma_j; \quad\text{  }\quad \epsilon_{ijk} \sim N(0, \sigma_j)
$$

or

$$
sd(\epsilon_{ijk})=\sigma_k; \quad\text{  }\quad \epsilon_{ijk} \sim N(0, \sigma_k)
$$

### Step 4. Find the proper random effects structure

Next, we used the beyond-optimal model with the correct variance
structure to find the proper random effects structure. In the case of
our data set, we had six sampling agencies, each with 1 to 3 locations,
and multiple samples collected over time at each location. The nested
structure of our data, along with our interest in using the model to
predict results in locations that haven't been sampled (rather than to
compare sampled locations and agencies to each other), led to the
identification of *agency* and *location* as potential nested random
effects. In this situation, the random part of a nested mixed effects
model has the form:

$$
random.effects_{ijk} = a_k + a_{j|k} + \epsilon_{ijk}
$$

where $a_k$ is a random intercept that allows for variation between
agencies, while $a_{j|k}$ represents variation between locations (*j*)
from the same agency (*k*). We assumed that $a_k$ and $a_{j|k}$ are
normally distributed, with standard deviations given below:

$$
a_k \sim N(0, \sigma_{agency})
$$

$$
a_{j|k}\sim N(0, \sigma_{location})
$$

The beyond-optimal gls model was compared to a linear mixed effects
(lme) nested random-intercept model (nlme package, Pinheiro et al.,
2021) fitted with REML, where the intercept was allowed to change per
agency, and per location nested within agency. Because the gls model and
the random-intercept model are nested models, they were compared using a
likelihood ratio test to see if one model was significantly better than
the other (p-value \< 0.05). The best-fit model was then selected based
on the lowest AIC value. For all COCs, the nested random-intercept model
fit the data better than the gls model with no random effects.

Intuitively, a random intercept for location nested within agency is
suitable for the stormwater data. Each location was sampled multiple
times over the 4-year data collection period, and we would expect data
within a location to be more similar than data between two locations.
Agencies may have differed slightly in sample collection methodologies,
including: timing of sample collection once a storm began, selection of
laboratory for sample analysis, and any biases in selection of
representative watersheds. These differences could lead to variability
in COC results by agency, and can be neatly captured in the random
component of the model.

### Step 5. Check for temporal and spatial correlation

The beyond-optimal model with the correct variance structure and random
effects structure was then examined for evidence of temporal and spatial
auto-correlation. Temporal auto-correlation plots were generated and
visually assessed for indications of correlation between various
sampling time lags; no evidence of temporal autocorrelation was found
for any COC. Spatial auto-correlation was assessed through two methods:
variograms, and spatially-explicit bubble plots of model residuals; no
evidence of significant spatial autocorrelation was found for any COC.

All tests for temporal and spatial auto-correlation were repeated
following selection of best-fit models.

### Step 6. Find the proper fixed effects structure

We used the strong potential landscape predictors from Step 1 to
generate an exhaustive set of fixed-effects formulae with combinations
of one, two and three potential landscape predictors. Predictors with
high correlation coefficients (≥0.85) were not allowed to be in formulae
together.

A set of models was generated using the fixed effects formulae, along
with the best-fit random effects and variance structures identified in
steps 3 and 4. Linear mixed effects models were applied using the nlme
package (Pinheiro et al, 2021), and fitting with maximum likelhood (ML)
estimation[^2]. Models where the sign (+ or --) of the predictor
coefficients did not match the coefficient signs from the linear model
from Step 1 were discarded. Models were then sorted according to AIC
value, and the top 20 models were examined for fit to individual
predictors. If weak landscape or temporal predictors (p-value \> 0.05)
were present in the model, these were eliminated, then plots of
residuals versus fitted values, agency, location, and landscape
predictors were examined. One to three candidate models were selected
for consideration as the best landscape predictor model. These candidate
models all had low AIC values, acceptable residual plots, and good fit
to individual landscape predictors. The form of the candidate models
was:

[^2]: As described in Faraway (2006), pg 156, REML estimation should not
    be used to compare models with different fixed effects because REML
    estimates the random effects by considering linear combinations of
    the data that remove the fixed effects. If the fixed effects change,
    the likelihoods of the two models will not be directly comparable.
    However, REML is generally considered to give better estimates for
    the random effects, so final models were fitted with REML

$$
Result_{ijk}=fixed.effects_{ijk} + a_k + a_{j|k} + \epsilon_{ijk}
$$

Using knowledge of chemical contaminant mobilization into stormwater, we
selected the best landscape predictor model for each COC.

### Step 7. Final model comparison to categorical land use models

Currently, stormwater managers often rely on categorical land use
designations to approximate COC concentrations in stormwater from
various locations. We set out to provide better information through the
use of landscape predictors to describe COC presence in stormwater. To
assess the suitability of our approach, three models were ultimately
fitted with REML and compared for each COC.

1.  **Null Model:** COC concentration is equal to median COC
    concentration over all sampling dates and locations

2.  **Categorical Land Use Model:** COC concentration is modeled as a
    linear mixed effects model, utilizing land use category (HDR, LDR,
    COM, IND), precipitation (rainfall and/or antecedent dry days), and
    season (for COCs where a seasonal trend appeared in the data).

3.  **Landscape Predictor Model:** COC concentration is modeled as a
    linear mixed effects model, utilizing up to three landscape
    predictors, precipitation (rainfall and/or antecedent dry days), and
    season (for COCs where a seasonal trend appeared in the data).

### Step 8. Bayesian model analysis

The best fit frequentist model structure from Step 6 was then applied to
a Bayesian framework using the brms package in R (Buerkner, 2017). The
brms package provides an R interface for performing Bayesian multi-level
(mixed effects) regression models using the programming language "Stan"
in the background (Stan Development Team, 2022). Models were examined
for the following elements:

1.  model convergence and adequate sampling of the parameter space using
    posterior traces,
2.  appropriateness of the variance structure, in cases where two
    variance structures had similar AIC values in the frequentist model
    selection (i.e., location vs. agency as the variance covariate),
3.  predictive accuracy using leave-one-out cross-validation (LOOCV) to
    examine influential outliers, calculate Pareto *k* values for each
    data point, and compare candidate models
4.  graphical posterior predictive checking, where observed data were
    compared to simulated data from the posterior predictive
    distribution.

Several models had data points with pareto K values \> 0.7, indicating
that these points may be influential outliers that affect model fitting.
In our case, a suitable strategy for reducing the influence of extreme
observations with high Pareto *k* values was to utilize the Student-t
distribution rather than the default Gaussian distribution as the
underlying data distribution for our Bayesian model. The Student-t
distribution has thicker tails, which can encompass some more extreme
observations.

### Step 9. Obtain Credibility Intervals from Bayesian model

The best fit Bayesian model from Step 8 was then ... (DESCRIPTION IN
PROGRESS)

## Results

Results for each COC are provided below.

### Copper

Based on linear models of *ln*-transformed copper versus individual
predictors, the strong predictors identified for copper include: totRes,
intURB, intURB_IND, grass, greenery, impervious, nodev, sqrt_traffic,
sqrt_popn, pm25_na, sqrt_CO2_tot, sqrt_CO2_com, sqrt_CO2_road,
sqrt_CO2_nonroad, devAge2, roof_intURB_IND (Fig 4.5).

![](images/Copper%20strong%20predictors%20fig_4_5.bmp)

**Figure 4.5** Strong predictors for copper, showing linear model fit
(blue line) for the relationship between ln-transformed copper
concentration and each predictor in turn.

The precipitation predictor used for copper was 21-day cumulative
precipitation. In addition, evidence of higher copper concentrations
during summer led us to add *summer* as a categorical predictor to the
copper model, where *summer* = 1 during July, August, September, and
*summer* = 0 for all other months.

Residuals plotted against fitted values showed signs of slight
heterogeneity (Fig 4.6, top left). Of the variance structures tested,
the best fit allows residual variation to differ by location *j.*

$$
sd(\epsilon_{ijk}) = \sigma_j
$$

![](images/Copper%20variance%20structure%20plot.bmp)

**Figure 4.6** Normalized residuals from beyond-optimal model, with no
variance structure (top left), with agency as a variance covariate (top
right), and with location as a variance covariate (bottom left).
Location as the variance covariate provided the best model fit.

The best model for copper is a random-intercept model, where the
intercept of the linear model is allowed to vary by agency (*k*), and by
location within each agency (*j*\|*k*). No signs of temporal or spatial
auto-correlation were detected in auto-correlation plots or variograms.

Two possible models emerged to capture the fixed effects:

$$
rain + summer + sqrt\_CO_2\_road + devAge2
$$

$$
rain + summer + sqrt\_ traffic + devAge2
$$

The first model's AIC score was slightly lower than that of the second
model (AIC=699.3 vs. 700.9, when models were fitted with ML); however,
vehicle wear is more directly associated with copper in stormwater than
are emissions. As a result, we selected the second model, with
*sqrt_traffic* as a predictor. Figure 4.7 shows the model fit for each
individual predictor, plotted against data points. Correlation between
the two predictors was low (correlation = 0.3).

![](images/Copper%20single%20predictors%20plot.bmp)

**Figure 4.7** Single-predictor plots for copper, showing fit of the
Landscape Predictor Model to each predictor in turn. Model fitting was
performed using maximum likelihood (ML) estimation.

Comparisons between the Null Model, Categorical Land Use Model, and
Landscape Predictor Model can be visualized through residuals (Fig. 4.8)
and comparative metrics such as AIC. The residual plots clearly show
good fit (residuals close to zero) for the Categorical Landuse Model and
for the Landscape Predictor Model.

![](images/Copper%20residual%20plot%20for%203%20models.bmp)

**Figure 4.8** Copper model residuals for the Null Model, Categorical
Land Use Model, and Landscape Predictor Model. Each bar represents one
watershed, with colors representing agencies. Model fitting was
performed using maximum likelihood (ML) estimation.

Final frequentist model AIC values (fitted with REML) for the three
models are: 1317.1 (Null Model), 721.9 (Categorical Landuse Model) and
720.6 (Landscape Predictor Model), with the Landscape Predictor Model
showing a slight improvement over the Categorical Landuse Model. Final
coefficient values for all three frequentist models are shown in Figure
4.9. The large variability in model coefficients for the Categorical
Landuse Model (shown in blue) indicates lower predictive power, because
confidence intervals on predictions will be large.

![](images/Copper%20model%20parameter%20values%20plot.bmp)

**Figure 4.9** Frequentist model coefficients for the Null Model
(green), Categorical Land Use Model (blue), and Landscape Predictor
Model (red). These coefficient values for linear mixed effects models
are based on fitting with restricted maximum likelihood (REML)
estimation, and may differ slightly from those fitted using maximum
likelihood (ML) estimation.

**Bayesian summary (plots are in development):**

The Bayesian model for total copper follows a Student-t distribution,
where:

$$
\ln(Cu_{ijk}) = 2.33 - 0.18*rain_{i} + 0.37*summer_{i} + 0.43*sqrt\_traffic_{ijk} + 0.46*devAge2_{ijk} + a_k + a_{j|k} + \epsilon_{ijk}
$$

Rain is 21-day cumulative precipitation, standardized; and summer is a
factor with value = 1 for July, August, September, and value = 0 for all
other months. Both landscape predictors were first transformed then
standardized prior to use. Subscripts indicate sample (*i*), location
(*j*) and agency (*k*).

Random effects ($a_k$ and $a_{j|k}$) follow a normal (Gaussian)
distribution, and residual variance $\epsilon_{ijk}$ follows a Student-t
distribution with $\nu=7.8$:

$$
a_k \sim N(0, \sigma_{agency});\quad\text{  }\quad \sigma_{agency} = 0.21
$$

$$
a_{j|k}\sim N(0, \sigma_{agency|location}); \quad\text{  }\quad \sigma_{agency|location} = 0.45
$$

$$
\epsilon_{ijk} \sim t_{7.8}(0, \sigma_j); \quad\text{    }\quad ln(\sigma_j) = \eta + u_j \quad\text{    }\quad \eta=-0.91; 
$$
$$ 
u_j \sim N(0,\sigma_0); \quad\text{    }\quad \sigma_0=0.21
$$

The Stormwater Heatmap presents the median predicted value over time
(i.e., median over all seasons and precipitation regimes), and use the
equation:

$$
\ln(Cu) = 2.33 + 0.43*sqrt\_traffic + 0.46*devAge2
$$

### Total Suspended Solids

Based on linear models of *ln*-transformed TSS versus individual
predictors, the strong predictors identified for TSS include: totRES,
sqrt_traffic, sqrt_popn, sqrt_CO2_res, sqrt_CO2_tot, sqrt_CO2_com,
sqrt_CO2_road, devAge2 (Fig 4.11).

![](images/TSS%20strong%20predictors.bmp)

**Figure 4.11** Strong predictors for TSS, showing linear model fit
(blue line) for the relationship between *ln*-transformed TSS
concentration and each predictor in turn.

The precipitation predictor used for TSS was 1-day cumulative
precipitation. There was no evidence of seasonal patterns to TSS in
stormwater.

Residuals plotted against fitted values showed signs of slight
heterogeneity (Fig 4.12, top left plot). Of the variance structures
tested, the best fit allows residual variation to differ by location
*j*.

$$
sd(\epsilon_{ijk}) = \sigma_j 
$$

![](images/TSS%20variance%20structure%20plot.bmp)

**Figure 4.12** Normalized residuals from beyond-optimal model, with no
variance structure (top left), with agency as a variance covariate (top
right) and with location as a variance covariate (bottom left). Location
as the variance covariate provided the best model fit.

The best model for TSS is a random-intercept model, where the intercept
of the linear model is allowed to vary by agency (*k*), and by location
within each agency (*j*\|*k*). No signs of temporal or spatial
auto-correlation were detected in auto-correlation plots or variograms.

Two possible models emerged to capture the fixed effects:

$$
rain + sqrt\_traffic + devAge2
$$

$$
rain + sqrt\_CO_2\_road + devAge2
$$

The AIC score for these models was 1240.2 and 1245.7, respectively
(models fitted with ML). We selected the first model as the most
suitable for TSS. Figure 4.13 shows the model fit for each individual
predictor, plotted against data points. Correlation between the two
predictors was low (correlation coefficient = 0.3).

![](images/TSS%20single%20predictor%20plots.bmp)

**Figure 4.13** Single-predictor plots for TSS, showing fit of the
Landscape Predictor Model to each predictor. Model fitting was performed
using maximum likelihood (ML) estimation.

Comparisons between the Null Model, Categorical Land Use Model, and
Landscape Predictor Model can be visualized through residuals (Fig.
4.14) and comparative metrics such as AIC. The residual plots clearly
show good fit (residuals close to zero) for the Categorical Landuse
Model and for the Landscape Predictor Model.

![](images/TSS%20residual%20plot%203%20models.bmp)

**Figure 4.14** TSS model residuals for the Null Model, Categorical Land
Use Model, and Landscape Predictor Model. Each bar represents one
watershed, with colors representing agencies. Model fitting was
performed using maximum likelihood (ML) estimation.

Final frequentist model AIC values (fitted with REML) for the three
models are: 1431.7 (Null Model), 1258.3 (Categorical Landuse Model) and
1252.8 (Landscape Predictor Model), with the Landscape Predictor Model
showing significant improvement over the Categorical Landuse Model.
Final coefficient values for all three frequentist models are shown in
Figure 4.15. The larger variability around Categorical Landuse Model
coefficients (shown in blue) indicates lower predictive power compared
to the Landscape Predictor Model, because confidence intervals on
predictions will be large.

![](images/TSS%20model%20parameters%20plot.bmp)

**Figure 4.15** Model coefficients for the Null Model (green),
Categorical Land Use Model (blue), and Landscape Predictor Model (red).
Final coefficient values for linear mixed effects models are based on
fitting with restricted maximum likelihood (REML) estimation, and may
differ slightly from those fitted using maximum likelihood (ML)
estimation.

**Bayesian summary (plots are in development):**

The Bayesian model for TSS is:

$$
\ln(TSS_{ijk}) = 10.29 + 0.16*rain_{i} + 0.38*sqrt\_traffic_{ijk} + 0.32*devAge2_{ijk} + a_k + a_{j|k} + \epsilon_{ijk}
$$

Rain is 1-day cumulative precipitation, standardized. Both landscape
predictors were first transformed then standardized prior to use.
Subscripts indicate sample (*i*), location (*j*) and agency (*k*).

Random effects ($a_k$ and $a_{j|k}$) and residual variance
$\epsilon_{ijk}$ follow a normal (Gaussian) distribution.

$$
a_k \sim N(0, \sigma_{agency});\quad\text{  }\quad \sigma_{agency} = 0.28
$$

$$
a_{j|k}\sim N(0, \sigma_{agency|location}); \quad\text{  }\quad \sigma_{agency|location} = 0.38
$$

$$
\epsilon_{ijk} \sim N(0, \sigma_j); \quad\text{    }\quad ln(\sigma_j) = \eta + u_j \quad\text{    }\quad \eta=-0.08; 
$$
$$ 
u_j \sim N(0,\sigma_0); \quad\text{    }\quad \sigma_0=0.30
$$

The Stormwater Heatmap presents the median predicted value over time
(i.e., median over all seasons and precipitation regimes), and use the
equation:

$$
\ln(TSS) = 10.29 + 0.38*sqrt\_traffic + 0.32*devAge2
$$

### Phosphorus

Based on linear models of *ln*-transformed total phosphorus (hereafter
referred to only as phosphorus) versus individual predictors, the strong
predictors identified for phosphorus include: urbRES, roofs,
sqrt_traffic, sqrt_popn, pm25_na, sqrt_slope, sqrt_CO2_res,
sqrt_CO2_tot, sqrt_CO2_road and devAge2 (Fig 4.16).

![](images/Phosphorus%20strong%20predictors.bmp)

**Figure 4.16** Strong predictors for phosphorus, showing linear model
fit (blue line) for the relationship between ln-transformed phosphorus
concentration and each predictor in turn.

The precipitation predictor used for phosphorus was 21-day cumulative
precipitation. In addition, evidence of higher phosphorus concentrations
during summer led us to add *summer* as a categorical predictor to the
phosphorus model (where *summer* = 1 during July, August, September, and
*summer* = 0 for all other months).

Residuals plotted against fitted values showed signs of slight
heterogeneity (Fig 4.17, left plot). Of the variance structures tested,
the best fit allows residual variation to differ by location *j*:

$$
sd(\epsilon_{ijk}) = \sigma_j
$$

![](images/Phosphorus%20variance%20structure.bmp)

**Figure 4.17** Normalized residuals from beyond-optimal model, with no
variance structure (top left), with agency as a variance covariate (top
right) and with location as a variance covariate (bottom left). Location
as the variance covariate provided the best model fit.

The best model for phosphorus is a random-intercept model, where the
intercept of the linear model is allowed to vary by agency (*k*), and by
location within each agency (*j*\|*k*). No signs of temporal or spatial
auto-correlation were detected in auto-correlation plots or variograms.

Two possible models emerged to capture the fixed effects:

$$
rain + summer + sqrt\_CO_2\_road
$$

$$
rain + summer
$$

The AIC score for the first model was slightly lower than that of the
second model (AIC=813.6 vs. 814.7, when models were fitted with ML). In
the first model, the predictor $sqrt\_CO_2\_road$ has a p-value of 0.08
when fitted with ML, indicating that it can be dropped from the model.
However, dropping the single landscape predictor results in a model with
no predictive potential for the Stormwater Heatmap. As a result, we
selected the model that includes $sqrt\_CO_2\_road$. Information for the
rain + summer only model is also provided below.

Figure 4.18 shows the model fit for $sqrt\_CO_2\_road$, plotted against
data points.

![](images/Phosphorus%20single%20predictors.bmp)

**Figure 4.18** Single-predictor plots for phosphorus, showing fit of
the Landscape Predictor Model to the single predictor. Model fitting was
performed using maximum likelihood (ML) estimation.

Comparisons between the Null Model, Categorical Land Use Model, and
Landscape Predictor Model can be visualized through residuals (Fig.
4.19), comparative metrics such as AIC. The residual plots clearly show
good fit (residuals close to zero) for the Categorical Landuse Model,
Landscape Predictor Model, and the Rain + Summer Only Model.

![](images/Phosphorus%20residual%20plots%204%20models.bmp)

**Figure 4.19** Phosphorus model residuals for the Null Model,
Categorical Land Use Model, Landscape Predictor Model, and Rain + Summer
Only Model (alternate model). Each bar represents one watershed, with
colors representing agencies. Model fitting was performed using maximum
likelihood (ML) estimation.

Final frequentist model AIC values (fitted with REML) for the four
models are: 1157.2 (Null Model), 829.8 (Categorical Landuse Model),
825.1 (Landscape Predictor Model) and 824.0 (Rain + Summer Model). The
Landscape Predictor Model shows an improvement over the Categorical
Landuse Model, and the Rain + Summer Model has the lowest AIC, slightly
improving over the Landscape Predictor Model. Final coefficient values
for all four frequentist models are shown in Figure 4.20.

![](images/Phosphorus%20model%20predictor%20values.bmp)**Figure 4.20**
Frequentist model coefficients for the Null Model (green), Categorical
Land Use Model (blue), Landscape Predictor Model (red), and Rain +
Summer Model (purple). These coefficient values for linear mixed effects
models are based on fitting with restricted maximum likelihood (REML)
estimation, and may differ slightly from those fitted using maximum
likelihood (ML) estimation.

**Bayesian summary (plots are in development):**

The Landscape Predictor model is slightly better than the Rain + Summer
model in the Bayesian modeling framework, when compared with the LOOCV.

The Bayesian model for total phosphorous follows a Student-t
distribution, where:

$$
\ln(P_{ijk}) = 4.55 - 0.15*rain_{i} + 0.51*summer_{i} + 0.30*sqrt\_CO_2\_road_{ijk} + a_k + a_{j|k} + \epsilon_{ijk}
$$

Rain is 21-day cumulative precipitation, standardized; and summer is a
factor with value = 1 for July, August, September, and value = 0 for all
other months. The $CO_2\_road$ predictor was first square-root
transformed, then standardized prior to use. Subscripts indicate sample
(*i*), location (*j*) and agency (*k*).

Random effects ($a_k$ and $a_{j|k}$) follow a normal (Gaussian)
distribution, and residual variance $\epsilon_{ijk}$ follows a Student-t
distribution with $\nu=13.4$:

$$
a_k \sim N(0, \sigma_{agency});\quad\text{  }\quad \sigma_{agency} = 0.55
$$

$$
a_{j|k}\sim N(0, \sigma_{agency|location}); \quad\text{  }\quad \sigma_{agency|location} = 0.51
$$

$$
\epsilon_{ijk} \sim t_{13.4}(0, \sigma_j); \quad\text{    }\quad ln(\sigma_j) = \eta + u_j \quad\text{    }\quad \eta=-0.64; 
$$
$$ 
u_j \sim N(0,\sigma_0); \quad\text{    }\quad \sigma_0=0.30
$$

The Stormwater Heatmap presents the median predicted value over time
(i.e., median over all seasons and precipitation regimes), and use the
equation:

$$
\ln(P) = 4.55 + 0.30*sqrt\_CO_2\_road
$$

Total phosphorus turned out to be a challenging chemical to model in
stormwater, perhaps because its main sources are from divergent land
uses. Waschbusch et al. (1999) found that lawns and roads contributed
\~80% of total and dissolved phosphorous loading, and that land use
affects the contribution from different sources: lawns and leaf litter
are more important in residential areas, while roads are more important
in commercial and industrial areas. Future efforts could focus on
identifying more effective landscape predictors for total phosphorus.

### Total Zinc

Based on linear models of ln-transformed total zinc versus individual
predictors, the strong predictors identified for total zinc include:
totRES, intURB_IND, grass, greenery, paved, impervious, trees,
sqrt_traffic, pm25_na, sqrt_CO2_tot, sqrt_CO2_com, sqrt_CO2_nonroad, and
roof_intURB_IND (Fig 4.21).

![](images/Total%20Zinc%20strong%20predictors%20plot.bmp)

**Figure 4.21** Strong predictors for total zinc, showing linear model
fit (blue line) for the relationsihp between *ln*-transformed total
zince concentration and each predictor in turn.

The precipitation predictor used for total zinc was 14-day cumulative
precipitation. In addition, evidence of higher total zinc concentrations
during summer led us to add *summer* as a categorical predictor to the
total zinc model (where *summer* = 1 during July, August, and September,
and *summer*= 0 for all other months).

Residuals plotted against fitted values showed a pattern, indicating a
chance of slight heteroskedasticity (Fig. 4.22, top left). Of the
variance structures tested, the best fit allows residual variation to
differ by location *j*.

$$
sd(\epsilon_j) = \sigma_j
$$

![](images/Total%20Zinc%20variance%20structure.bmp)**Figure 4.22**
Normalized residuals from beyond-optimal model, with no variance
structure (top left), with agency as a variance covariate (top right),
and with location as a variance covariate (bottom left). Location as the
variance covariate provided the best model fit.

The best model for total zinc is a random-intercept model, where the
intercept of the linear model is allowed to vary by agency (*k*), as
well as by location within each agency (*j*\|*k*). No signs of temporal
or spatial auto-correlation were detected in auto-correlation plots or
variograms.

Two possible models emerged to capture the fixed effects:

$$
rain + summer + paved + sqrt\_CO_2\_tot + rain*paved
$$

$$
rain + summer + greenery + sqrt\_traffic + rain*greenery
$$

The AIC scores for these two models were very close, with the first
model's AIC score slightly higher than that of the second model
(AIC=722.7 vs. 721.5, when models were fitted with ML). The predictor
p-values for the first model were all very low (p-value \< 0.005),
whereas one predictor in the second model (*sqrt_traffic*) had a p-value
of 0.05. As a result, we selected the first model. Figure 4.23 shows the
model fit for each individual predictor, plotted against data points.
Correlation between the two predictors was low (correlation coefficient
= 0.3).

![](images/Total%20Zinc%20single%20predictors.bmp)**Figure 4.23**
Single-predictor plots for total zinc, showing fit of the Landscape
Predictor Model to each predictor. Model fitting was performed using
maximum likelihood (ML) estimation.

Figure 4.24 shows the interaction between rain and paved, with more
paved watersheds shown in reds and oranges, and less paved watersheds
shown in blues and purples. In highly paved areas, there is a stronger
first-flush effect; greater amounts of 14-day cumulative rainfall reduce
the subsequent zinc concentration in stormwater.

![](images/Total%20Zinc%20interaction%20plot%20rain_paved.bmp)**Figure
4.24** Plot showing the interaction between rain and paved that is
present in the best fit model. In highly paved areas, increasing amounts
of rain result in a dilution of zinc in stormwater. Model fitting was
performed using maximum likelihood (ML) estimation.

Comparisons between the Null Model, Categorical Land Use Model, and
Landscape Predictor Model can be visualized through residuals (Fig.
4.25) and comparative metrics such as AIC. The residual plots clearly
show good fit (residuals close to zero) for the Categorical Landuse
Model and for the Landscape Predictor Model.

![](images/Total%20Zinc%20residual%20plot%20for%203%20models.bmp)**Figure
4.25** Total zinc model residuals for the Null Model, Categorical Land
Use Model, and Landscape Predictor Model. Each bar represents one
watershed, with colors representing agencies. Model fitting was
performed using maximum likelihood (ML) estimation.

Final frequentist model AIC values (fitted with REML) for the three
models are: 1324.53 (Null Model), 748.4 (Categorical Landuse Model), and
745.2 (Landscape Predictor Model), with the Landscape Predictor Model
showing an improvement over the Categorical Landuse Model. Final
coefficient values for all three frequentist models are shown in Figure
4.26. The large variability in model coefficients for the Categorical
Landuse Model (shown in blue) indicates low predictive power, because
confidence intervals on predictions will be large.

![](images/Total%20Zinc%20model%20parameters.bmp)

**Figure 4.26** Frequentist model coefficients for the Null Model
(green), Categorical Land Use Model (blue), and Landscape Predictor
Model (red). Final coefficient values for linear mixed effects models
are based on fitting with REML, and may differ slightly from coefficient
values based on fitting with ML.

**Bayesian summary (plots are in development):**

The Bayesian model for total zinc follows a Gaussian distribution,
where:

$$
ln(totZn_{ijk}) = 4.09 - 0.16*rain_{i} + 0.38*summer_{i} + 0.44*sqrt\_CO_2\_tot_{ijk} + 0.55*paved_{ijk} - 0.08*rain_{i}*paved_{ijk} + a_k + a_{j|k} + \epsilon_{ijk}
$$

Rain is 14-day cumulative precipitation, standardized; and summer is a
factor with value = 1 for July, August, September, and value = 0 for all
other months. Landscape predictors were first transformed, if necessary
($CO_2\_tot$ was square-root transformed), then standardized prior to
use. Subscripts indicate sample (*i*), location (*j*) and agency (*k*).

Random effects ($a_k$ and $a_{j|k}$) and residual variance
$\epsilon_{ijk}$ follow a normal (Gaussian) distribution.

$$
a_k \sim N(0, \sigma_{agency});\quad\text{  }\quad \sigma_{agency} = 0.23
$$

$$
a_{j|k}\sim N(0, \sigma_{agency|location}); \quad\text{  }\quad \sigma_{agency|location} = 0.47
$$

$$
\epsilon_{ijk} \sim N(0, \sigma_j); \quad\text{    }\quad ln(\sigma_j) = \eta + u_j \quad\text{    }\quad \eta=-0.68; 
$$
$$ 
u_j \sim N(0,\sigma_0); \quad\text{    }\quad \sigma_0=0.35
$$

The Stormwater Heatmap presents the median predicted value over time
(i.e., median over all seasons and precipitation regimes), and use the
equation:

$$
\ln(totZn) = 4.09 + 0.44*sqrt\_CO_2\_tot + 0.55*paved
$$

### Total Kjeldahl Nitrogen

Out of 421 Total Kjeldahl nitrogen (TKN) samples, 41 samples (9.7%) were
flagged as non-detects, with a variety of detection limits ranging from
30 to 500. The majority of non-detect samples came from three agencies:
Pierce County, Port of Tacoma, and Snohomish County (Fig. 4.27). High
detection limits in Pierce County and Port of Tacoma strongly truncated
the lower half of these data sets. One non-detect sample from TAC_HDR
was flagged by the laboratory as estimated, with an estimated value of
255. For the purposes of our analysis, we assume that this estimated
sample value is correct.

![](images/Total%20Kjeldahl%20Nitrogen%20sample%20values%20prior%20to%20ROS.bmp)**Figure
4.27** Concentrations of total Kjeldahl nitrogen in samples collected by
location. Red dots indicate detected values, while turqoise dots
indicate the detection limit for samples flagged as non-detect.

Although the EPA allows substitution of (0.5 x detection limit) for
censored values when less than 15% of samples are non-detect (USEPA,
2009), substitution can add a pattern to the data that is different than
the pattern of the data itself (Helsel, 2012). As a result, we performed
regression on order statistics (ROS) at each location using the NADA
package (Lee, 2020). ROS uses the uncensored and censored values to
model the likely data distribution, then draws from the distribution to
generate modeled values for the censored data. Because we ran ROS on a
location-by-location basis, we do not anticipate the introduction of
extraneous patterns that affect the landscape predictors. Rainfall and
seasonality patterns could potentially be affected for the 40 data
points that were generated through ROS; however, because \>90% of data
were not censored, this effect should be relatively small. Figure 4.28
shows the modeled concentrations of TKN in turquoise. All statistics
were performed using the modeled values generated by ROS, in place of
censored data.

![](images/Total%20Kjeldahl%20Nitrogen%20ROS%20modeled%20data%20points.bmp)

**Figure 4.28** Actual (red) and modeled (turquoise) concentrations of
total Kjeldahl nitrogen in samples collected by location. Modeled values
were generated by regression on order statistics, to replace the
detection limit on censored data.

Based on linear models of *ln*-transformed TKN versus individual
predictors, the strong predictors identified for TKN include: roofs,
nodev, traffic, sqrt_popn, sqrt_CO2_res, sqrt_CO2_tot, sqrt_CO2_road,
devAge2, roof_inURB and roof_intURB_IND (Fig. 4.29).

![](images/Total%20Kjeldahl%20Nitrogen%20strong%20predictors.bmp)**Figure
4.29** Strong predictors for total Kjeldahl nitrogen (TKN), showing
linear model fit (blue line) for the relationship between
*ln*-transformed TKN concentration and each predictor in turn.

The precipitation predictor used for TKN was 14-day cumulative
precipitation. In addition, evidence of higher TKN concentrations during
summer led us to add summer as a categorical predictor to the TKN model
(where summer = 1 during July, August, September, and summer = 0 for all
other months).

Residuals plotted against fitted values showed signs of slight
heterogeneity (Fig. 4.30, top left plot). Of the variance structures
tested, the best fit allows residual variation to differ by agency *k*.

$$
sd(\epsilon_k)=\sigma_k
$$

![](images/Total%20Kjeldahl%20Nitrogen%20variance%20structure_censtat.bmp)**Figure
4.30** Normalized residuals from beyond-optimal model, with no variance
structure (top left), with agency as a variance covariate (top right),
and with location as a variance covariate (bottom left). Agency as teh
variance covariate provided the best model fit.

The best model for TKN is a random-intercept model, where the intercept
of the linear model is allowed to vary by agency (*k*), as well as by
location within each agency (*j*\|*k*). No signs of temporal or spatial
auto-correlation were detected in auto-correlation plots or variograms.

Three possible models emerged to capture the fixed effects:

$$
rain + summer + sqrt\_traffic + devAge2
$$

$$
rain + summer + sqrt\_CO_2\_road + devAge2
$$

$$
rain + summer + sqrt\_traffic + nodev
$$

Each of these models captures two major contributors to total nitrogen:
vehicles, and amount/age of development. The AIC scores for all three
models were relatively close (836.0, 838.4, 840.9, respectively, when
models were fitted using ML).

We selected the first model, with landscape predictors *sqrt_traffic* +
*devAge2*. While all models fit the data reasonably well, we felt that
traffic (rather than emissions) were more likely to characterize the
movement of TKN into stormwater. Also, *devAge2* was a stronger
predictor in the first model (p-value = 0.006), compared to *nodev* in
the third model (p-value = 0.033). Figure 4.31 shows the model fit for
each individual predictor, plotted against data points. Correlation
between the two predictors was low (correlation coefficient = 0.4).

![](images/Total%20Kjeldahl%20Nitrogen%20single%20predictors.bmp)**Figure
4.31** Single-predictor plots for total Kjeldahl nitrogen, showing fit
of the Landscape Predictor Model to each predictor. Model fitting was
performed using maximum likelihood (ML) estimation.

Comparisons between the Null Model, Categorical Land Use Model, and
Landscape Predictor Model can be visualized through residuals (Fig.
4.32) and comparative metrics such as AIC. The residual plots clearly
show good fit (residuals close to zero) for the Categorical Landuse
Model and for the Landscape Predictor Model.

![](images/Total%20Kjeldahl%20Nitrogen%20residuals%20from%203%20models.bmp)

**Figure 4.32** Total Kjeldahl nitrogen model residuals for the Null
Model, Categorical Land Use Model, and Landscape Predictor Model. Each
bar represents one watershed, with colors representing agencies. Model
fitting was performed using maximum likelihood (ML) estimation.

Final frequentist model AIC values (fitted with REML) for the three
models are: 1101.0 (Null Model), 858.8 (Categorical Landuse Model) and
854.4 (Landscape Predictor Model), with the Landscape Predictor Model
showing an improvement over the Categorical Landuse Model. Final
coefficient values for all three frequentist models are shown in Figure
4.33. The relatively large variability in model coefficients for the
Categorical Landuse Model (shown in blue) indicates lower predictive
power, because confidence intervals on predictions will be large.

![](images/Total%20Kjeldahl%20Nitrogen%20model%20coefficients.bmp)**Figure
4.33** Model coefficients for the Null Model (green), Categorical Land
Use Model (blue), and Landscape Predictor Model (red). Final coefficient
values for linear mixed effects models are based on fitting with
restricted maximum likelihood (REML) estimation, and may differ slightly
from those fitted using maximum likelihood (ML) estimation.

**Bayesian summary (plots are in development):**

The Bayesian model for TKN was constructed using the censored data
function within the brms package. The best fit model follows a Student-t
distribution where:

$$
\ln(TKN_{ijk}) = 6.61 - 0.17*rain_i + 0.58*summer_i + 0.23*sqrt\_traffic_{ijk} + 0.22*devAge2_{ijk} + a_k + a_{j|k} + \epsilon_{ijk}
$$

Rain is 14-day cumulative precipitation, standardized; and summer is a
factor with value = 1 for July, August, September, and value = 0 for all
other months. Landscape predictors were first transformed, if necessary
(*traffic* was square-root transformed, *devAge* was squared), then
standardized prior to use. Subscripts indicate sample (*i*), location
(*j*) and agency (*k*).

Random effects ($a_k$ and $a_{j|k}$) follow a normal (Gaussian)
distribution, and residual variance $\epsilon_{ijk}$ follows a Student-t
distribution with $\nu=3.03$:$$
a_k \sim N(0, \sigma_{agency});\quad\text{  }\quad \sigma_{agency} = 0.18
$$

$$
a_{j|k}\sim N(0, \sigma_{agency|location}); \quad\text{  }\quad \sigma_{agency|location} = 0.22
$$

$$
\epsilon_{ijk} \sim t_{3.03}(0, \sigma_k); \quad\text{    }\quad ln(\sigma_k) = \eta + u_k \quad\text{    }\quad \eta=-0.80; 
$$
$$ 
u_k \sim N(0,\sigma_0); \quad\text{    }\quad \sigma_0=0.57
$$

Predictions presented in the Stormwater Heatmap represent the median
predicted value over time (i.e., median over all seasons and
precipitation regimes), and use the equation:

$$
ln(TKN) = 6.61 + 0.23*sqrt\_traffic + 0.22*devAge2
$$

## Translating Equations to the Stormwater Heatmap

The process of translating statistical equations for chemical
contaminants to the Stormwater heatmap involved manipulation of the grid
and equations.

### Preparing the Base Map

The Puget Sound watersheds base map was prepared through three steps:

1.  each grid was convolved on the base map,

2.  the range of landscape predictor values was truncated,

3.  regression equations were applied using landscape predictor values
    in each grid box.

**[CHRISTIAN - ADD A FEW SENTENCES ABOUT HOW EACH GRID WAS CONVOLVED:
for example, is each grid square made up of many smaller parts? Why was
convolving necessary? What are the dimensions of each grid square/
rectangle?]**

Truncation of landscape predictor values was necessary because, for some
predictors, the min and/or max over the entire Puget Sound region are
far beyond the range of landscape predictor values in the S8 monitoring
data that were used for generating model equations. We calculated the
mean and standard deviation for each landscape predictor over the 14 S8
monitoring locations, and capped the Puget Sound base map to 3 standard
deviations of the mean. **[CHRISTIAN - IS THIS CORRECT? OR DID WE FIRST
TRANSFORM AND CENTER DATA, *THEN* CAP AT 3 SD'S?]** This helps avoid
extrapolating beyond the range where linear relationships between
predictors and COCs may no longer apply.

**CHRISTIAN - I WOULD LOVE A FIGURE HERE -- A BOX PLOT SHOWING THE RANGE
OF VALUES FOR EACH OF THE PREDICTORS WE USE (sqrt_traffic, devAge2,
sqrt_CO2_road, sqrt_CO2_tot, paved), WITH THE TRUNCATED RANGE SHOWN NEXT
TO EACH BOX. I CAN MAKE THE FIGURE IF YOU PROVIDE THE DATA, OR IF YOU'D
LIKE TO MAKE/ADD IT, THAT IS FINE TOO.**

Truncation was especially important for the traffic predictor, because
traffic levels on high-volume roads such as freeways can far exceed the
traffic levels in our monitored locations. The maximum traffic level in
the base map was capped at 31,000 AADT **[CHRISTIAN - IS THIS THE
CORRECT VALUE AT WHICH WE CAPPED TRAFFIC?]**. On freeways, which were
not analyzed in this study, traffic can reach 240,000 AADT. Using
highway runoff data from the whole United States (USGS Highway Runoff
DataBase, accessed 11/01/21), we observed that linear equations for TSS
provide predictions that are too high when traffic is allowed to reach
levels near 240,000, but provide believable predictions when traffic
levels are capped at 31,000 AADT. This suggests that, for at least some
COCs, traffic may be a linear predictor over the values found in our
data, but may reach an asymptote at much higher traffic volumes. It also
suggests that caution should be used when interpreting predictions for
areas with exceptionally high traffic volumes.

### Applying Mixed Effects Equations to the Stormwater Heatmap

The equations that were fitted to the S8 monitoring data required a
specified variance structure to account for heteroskedasticity, as well
as a nested structure for the random effects. Homoskedasticity is an
important pre-requisite to constructing linear models between predictors
and dependent variables, and both the locations and the agencies had
some level of variability in the spreads of their data (Fig. 4.35).

![](images/TSS%20variability%20by%20location%20and%20agency_color.bmp)**Figure
4.35** Spread of the S8 monitoring data for total suspended solids (TSS)
by location (top) and by agency (bottom), with color coding by agency.
Note the variability in spread per location (e.g., blue boxes vs. green
boxes) as well as per agency (e.g., red boxes vs. green boxes).

With respect to translating mixed effects model equations to the
Stormwater Heatmap, the equations are substantially simplified.
Predicting mean COC concentrations allow the variance structure and
nested random effects terms to go to their mean value of 0. Furthermore,
rainfall and the summer predictor, where applicable, are also set to
their mean value of 0. Thus the generic COC equation: $$
\ln(COC_{ijk}) = \beta_0 + \beta_1*rain_i + \beta_2*summer_i + \beta_3*predictor1_{ijk} + \beta_2*predictor2_{ijk} + a_k + a_{j|k} + \epsilon_{ijk}
$$

$$
a_k \sim N(0, \sigma_{agency})
$$

$$
a_{j|k}\sim N(0, \sigma_{agency|location})
$$

$$
\epsilon_{ijk} \sim N(0, \sigma_k)
$$

becomes simplified to:

$$
\ln(COC) = \beta_0 + \beta_1*0 + \beta_2*0 + \beta_3*predictor1 + \beta_2*predictor2 + 0 + 0 + 0
$$

and finally:

$$
\ln(COC) = \beta_0 + \beta_3*predictor1 + \beta_2*predictor2
$$

In the Bayesian framework, credibility intervals (CIs) generated around
predicted chemical concentrations integrate variability in residuals
$\epsilon_{ijk}$ as well as in random effects $a_k$ and $a_{j|k}$. In
addition, we added provisions to capture variability in the rain
predictor and in the summer predictor. [DESCRIPTION IN PROCESS]

## **Citations:**

Buerkner, Paul-Christian, 2017. brms: An R Package for Bayesian
Multilevel Models Using Stan. *Journal of Statistical Software*, 80(1),
1-28. `doi:10.18637/jss.v080.i01`

Faraway, Julian J. Extending the Linear Model with R: Generalized
Linear, Mixed Effects and Nonparametric Regression Models. Boca Raton
(FL): Chapman & Hall/CRC; 2006.

Helsel, Dennis R. Statistics for Censored Environmental Data Using
Minitab and R. 2nd Edition. Hoboken, NJ: John Wiley & Sons, Inc; 2012.

Hobbs, W., B. Lubliner, N. Kale, and E. Newell, 2015. Western Washington
NPDES Phase 1 Stormwater Permit: Final Data Characterization 2009-2013.
Washington State Department of Ecology, Olympia, WA. Publication No.
15-03-001. Available online at:
<https://fortress.wa.gov/ecy/publications/SummaryPages/1503001.html>

Lee, Lopaka, 2020. NADA: Nondetects and Data Analysis for Environmental
Data. R package version 1.6-1.1. Available online at:
<https://CRAN.R-project.org/package=NADA>

Pinheiro J, Bates D, DebRoy S, Sarkar D, R Core Team, 2021. nlme: Linear
and Nonlinear Mixed Effects Models. R package version 3.1-152. Available
online at: <https://CRAN.R-project.org/package=nlme>

R Core Team, 2021. R: A language and environment for statistical
computing. R Foundation for Statistical Computing, Vienna, Austria.
Available online at: <https://www.R-project.org/>

Stan Development Team, 2022. *Stan Modeling Language User's Guide and
Reference Manual*. Available online at:
<https://mc-stan.org/users/documentation/>.

U.S. Environmental Protection Agency, 2009, Statistical analysis of
groundwater monitoring data at RCRA facilities, Unified guidance, EPA
530-R-09-007.

USGS Highway Runoff DataBase. Website visited 11/01/2021. Available
online at:
<https://www.usgs.gov/software/hrdb-highway-runoff-database-software-page>

Waschbusch, R.J., W.R. Selbig, and R.T. Bannerman, 1999. Sources of
Phosphorus in Stormwater and Street Dirt from Two Urban Residential
Basins In Madison, Wisconsin, 1994--95. U.S. Geological Survey
Water-Resources Investigations Report 99--4021.

Zuur AF, Ieno EN, Walker NJ, Saveliev AA, Smith GM. Mixed Effects Models
and Extensions in Ecology with R. New York (NY): Springer; 2009.
